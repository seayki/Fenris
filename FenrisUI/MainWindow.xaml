<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="FenrisUI.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:models="using:Fenris.Models"
    xmlns:localUI="using:FenrisUI"
    xmlns:UIModels="using:FenrisUI.Models"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:toolkit="using:CommunityToolkit.WinUI.Controls"
    mc:Ignorable="d"
    Title="FenrisUI">
    
    <ScrollViewer x:Name="MainScrollViewer" 
                  VerticalScrollBarVisibility="Auto" 
                  HorizontalScrollBarVisibility="Disabled" 
                  VerticalScrollMode="Enabled" 
                  ZoomMode="Disabled"
                  PointerWheelChanged="MainScrollViewer_PointerWheelChanged">
        <StackPanel Margin="0, 0, 0, 0" Background="#ffffff">
            <!-- Custom header with an icon and text -->
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,0,0" Background="#ffffff" Height="70">
                <Image Source="/Assets/FenrisBlockIcon.png" Width="30" Height="30" Margin="40,0,10,0" VerticalAlignment="Center"/>
                <TextBlock VerticalAlignment="Center" FontFamily="Verdana" FontSize="24">
                 <Span FontSize="18">Fenris</Span>
                 <Span FontWeight="Bold"> Blocker</Span>
                </TextBlock>
                <Border Height="1" Background="#E0E0E0" Margin="10,5"/>
            </StackPanel>
            <Pivot Margin="40, 20, 40, 0" Padding="10" CornerRadius="15">
                <PivotItem Header="Apps" Margin="0,30,0,0" Background="#ffffff" FontFamily="Verdana" Padding="30">
                    <Grid>
                        <!-- Define two columns -->
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <!-- Column 0: Processes ListView -->
                            <ColumnDefinition Width="*" />
                            <!-- Column 1: Additional content -->
                        </Grid.ColumnDefinitions>
                        <!-- Processes ListView in Column 0 -->
                        <Grid Grid.Column="0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <!-- Tag Input and Tags on the Same Row -->
                            <Grid Grid.Row="0" Margin="0,0,0,10">
                                <!-- Define columns: one for the tag section (auto-sized) and one for the button (stretched to take remaining space) -->
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <!-- Tag Input and List Section (Left Side) -->
                                <Border Grid.Column="0" 
                                    Background="#fcfcfc" 
                                    CornerRadius="20" 
                                    Padding="10" 
                                    BorderThickness="0">
                                    <StackPanel Orientation="Horizontal" Spacing="10" VerticalAlignment="Center">
                                        <TextBox x:Name="TagInput" Width="200" PlaceholderText="Add filter" KeyDown="TagInput_KeyDown" FontFamily="Verdana" CornerRadius="15"/>
                                        <Button Content="Add" Click="AddTag_Click" FontFamily="Verdana" CornerRadius="15"/>
                                        <!-- Tag List -->
                                        <ItemsControl x:Name="TagList" ItemsSource="{x:Bind Tags, Mode=OneWay}" VerticalAlignment="Center">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <StackPanel Orientation="Horizontal" Spacing="6"/>
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal" Spacing="4" Background="#e0e0e0" Padding="4" CornerRadius="4">
                                                        <TextBlock Text="{Binding}" FontSize="12" VerticalAlignment="Center" FontFamily="Verdana"/>
                                                        <Button Content="x" FontSize="10" Width="16" Height="16" Padding="0" Click="RemoveTag_Click" Tag="{Binding}" FontFamily="Verdana"/>
                                                    </StackPanel>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </StackPanel>
                                </Border>

                                <!-- Save Changes Button (Right Side) -->
                                <Button Grid.Column="1" Margin="0,10,20,0" Height="40" Click="UpdateApps_Click" Foreground="#0a0a0a" CornerRadius="20" Background="#5566FF" FontFamily="Verdana" HorizontalAlignment="Right">
                                    <StackPanel Orientation="Horizontal" Spacing="5">
                                        <!-- Enhanced Shield Icon -->
                                        <Path 
                                            Data="M6,0 L9,2 C10,3 11,5 11,6 V9 C11,10 10,11 9,11.5 L6,12 C5,12 4,11.5 3,11 V6 C3,5 4,3 5,2 L6,0 Z M6,1 C5.5,1 5,2 5,3 V9 C5,10 5.5,11 6,11 C6.5,11 7,10 7,9 V3 C7,2 6.5,1 6,1 Z" 
                                            Fill="#0a0a0a" 
                                            Width="12" 
                                            Height="12" 
                                            VerticalAlignment="Center"
                                            Stretch="Uniform"/>
                                        <!-- Button Text -->
                                        <TextBlock Text="Save Changes" VerticalAlignment="Center" Foreground="#0a0a0a" FontFamily="Verdana" FontWeight="Medium" FontSize="14"/>
                                    </StackPanel>
                                </Button>
                            </Grid>

                            <ListView Grid.Row="1" ItemsSource="{x:Bind Processes, Mode=OneWay}" 
                            IsItemClickEnabled="True" ItemClick="ProcessList_ItemClick" 
                            Name="ProcessList">
                                <ListView.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapGrid Orientation="Horizontal" MaximumRowsOrColumns="9"/>
                                    </ItemsPanelTemplate>
                                </ListView.ItemsPanel>
                                <ListView.ItemTemplate>
                                    <DataTemplate x:DataType="models:Process">
                                        <StackPanel Orientation="Vertical" Margin="10, 10, 10, 10" Width="150" CornerRadius="10" Padding="10" Background="#eeeeee">
                                            <Image Source="{x:Bind IconUrl}" Width="100" Height="48" Margin="0,0,0,0"/>
                                            <TextBlock Text="{x:Bind Name}" FontSize="14" TextAlignment="Center" Foreground="#0a0a0a" FontFamily="Robot"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>
                        </Grid>
                    </Grid>
                </PivotItem>
                <PivotItem Header="Websites" FontFamily="Verdana">
                    <Border CornerRadius="25" Background="#ffffff">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <StackPanel Grid.Row="0" HorizontalAlignment="Center" Spacing="10" Margin="0, 100, 0, 0" MaxWidth="1500" Width="Auto">
                                <TextBlock Text="Enter website to block." FontSize="24" FontWeight="Medium" FontFamily="Verdana" Margin="0, 0, 0, 10" HorizontalAlignment="Center"/>

                                <!-- Grid to hold TextBox and Button -->
                                <Grid MaxWidth="1500" HorizontalAlignment="Center">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <TextBox x:Name="WebsiteTextBox"
                             Grid.Column="0"
                             PlaceholderText="example.com"
                             FontFamily="Verdana"
                             Padding="10"
                             Width="1100" 
                                        MaxWidth="1400"
                             HorizontalAlignment="Stretch"/>
                                    <Button x:Name="AddBlockButton"
                            Grid.Column="1"
                            Content="Add"
                            Margin="10,0,0,0"
                            Padding="10,5"
                            Background="#3b62de"
                            Click="ApplyBlockUrl_Click" FontFamily="Verdana"/>
                                </Grid>

                                <GridView x:Name="BasicGridView"
                                    ItemsSource="{x:Bind Labels, Mode=OneWay}" 
                                    IsItemClickEnabled="True"
                                    SelectionMode="Single"
                                    HorizontalAlignment="Center"
                                    Margin="0, 10, 0, 10"
                                    MinHeight="100">
                                    <GridView.ItemTemplate>
                                        <DataTemplate x:DataType="UIModels:WebsiteCategory">
                                            <Button HorizontalAlignment="Center" Padding="8" MinWidth="130" Margin="5" FontFamily="Verdana" Click="ApplyLabelBlock_Click" Tag="{x:Bind Label}">
                                                <StackPanel Orientation="Horizontal" Spacing="10">
                                                    <FontIcon Glyph="{x:Bind Icon.Glyph}" FontSize="14" />
                                                    <TextBlock Text="{x:Bind Label}" VerticalAlignment="Center" FontFamily="Verdana"/>
                                                </StackPanel>
                                            </Button>
                                        </DataTemplate>
                                    </GridView.ItemTemplate>
                                </GridView>

                                <StackPanel HorizontalAlignment="Center" Spacing="20">
                                    <TextBlock Text="Blocked Websites." FontSize="22" FontFamily="Verdana" FontWeight="Medium"  HorizontalAlignment="Center"/>
                                    <ListView ItemsSource="{x:Bind urlBlocks}">
                                        <ListView.ItemTemplate>
                                            <DataTemplate x:DataType="UIModels:UrlBlock">
                                                <StackPanel Orientation="Horizontal" MinWidth="800">
                                                    <Grid Width="800">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*" />
                                                            <ColumnDefinition Width="Auto" />
                                                            <ColumnDefinition Width="Auto" />
                                                        </Grid.ColumnDefinitions>

                                                        <StackPanel Orientation="Horizontal" Spacing="10" Grid.Column="0" Background="#ececec" Padding="10, 0, 0, 0" CornerRadius="10">
                                                            <Image Width="16" Height="16" Source="{x:Bind Icon, Mode=OneWay}" />
                                                            <TextBlock Text="{x:Bind Url}" VerticalAlignment="Center" FontFamily="Verdana"/>
                                                        </StackPanel>

                                                        <Button Content="{x:Bind BlockType, Mode=OneWay}"
                                                                MinWidth="100"
                                                                Margin="10, 0, 0, 0"
                                                                Background="{x:Bind BackgroundColor}"
                                                                VerticalAlignment="Center" 
                                                                Click="UpdateBlockTypeButton_Click"
                                                                Grid.Column="1" FontFamily="Verdana"/>
                                                        <Button Content="Remove" 
                                                                Tag="{x:Bind Url}"
                                                                VerticalAlignment="Center" 
                                                                HorizontalAlignment="Center"
                                                                Margin="10, 0, 0, 0" 
                                                                Grid.Column="2" 
                                                                Click="RemoveWebBlock_Click"
                                                                Background="#b93d37" FontFamily="Verdana"/>
                                                    </Grid>
                                                </StackPanel>
                                            </DataTemplate>
                                        </ListView.ItemTemplate>
                                    </ListView>

                                </StackPanel>
                            </StackPanel>
                        </Grid>
                    </Border>
                </PivotItem>
                <PivotItem Header="Schedule" FontFamily="Verdana">
                    <!-- Block Status -->
                    <StackPanel Orientation="Vertical" Margin="0,0,0,0"
                                xmlns:toolkit="using:CommunityToolkit.WinUI.Controls"
                                HorizontalAlignment="Left">
                        <Border Padding="20" Background="White" CornerRadius="20">
                            <Grid HorizontalAlignment="Center" MaxWidth="2010">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <!-- Title -->
                                <Grid Grid.Row="0" VerticalAlignment="Center">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- Title and Icon -->
                                    <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10" VerticalAlignment="Center" HorizontalAlignment="Center">
                                        <TextBlock FontFamily="Verdana" FontSize="22" Text="Block Schedule"  FontWeight="Medium"/>
                                        <FontIcon Glyph="" FontFamily="Segoe MDL2 Assets" FontSize="24"/>
                                        <TextBlock FontFamily="Verdana" FontSize="14" Text="(Select days and timeframes)"  VerticalAlignment="Center" FontWeight="Medium"/>
                                        <TextBlock Text="Block Status" VerticalAlignment="Center" FontFamily="Verdana" FontSize="16" FontWeight="Bold" Margin="20,0,0,0"/>
                                        <Ellipse Width="12" Height="12" VerticalAlignment="Center" Fill="{x:Bind BlockStatusColor, Mode=OneWay}"/>
                                    </StackPanel>

                                    <!-- Pushes the button to the right -->
                                    <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right" Spacing="10">
                                        <Button Margin="0,10,20,0" Height="40" Click="UpdateSchedule_Click" Foreground="#0a0a0a" CornerRadius="20" Background="#5566FF" FontFamily="Verdana">
                                            <StackPanel Orientation="Horizontal" Spacing="5">
                                                <!-- Enhanced Shield Icon -->
                                                <Path 
                                 Data="M6,0 L9,2 C10,3 11,5 11,6 V9 C11,10 10,11 9,11.5 L6,12 C5,12 4,11.5 3,11 V6 C3,5 4,3 5,2 L6,0 Z M6,1 C5.5,1 5,2 5,3 V9 C5,10 5.5,11 6,11 C6.5,11 7,10 7,9 V3 C7,2 6.5,1 6,1 Z" 
                                 Fill="#0a0a0a" 
                                 Width="12" 
                                 Height="12" 
                                 VerticalAlignment="Center"
                                 Stretch="Uniform"/>
                                                <!-- Button Text -->
                                                <TextBlock Text="Update Schedule" VerticalAlignment="Center" Foreground="#0a0a0a" FontFamily="Verdana" FontWeight="Medium" FontSize="14"/>
                                            </StackPanel>
                                        </Button>
                                    </StackPanel>
                                </Grid>

                                <!-- Seven Day Cubes -->
                                <Grid Grid.Row="1" HorizontalAlignment="Center" Margin="0,20,0,0" x:Name="DayWrapPanel" ColumnSpacing="60" RowSpacing="20">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Vertical" Spacing="5" Margin="10">
                                        <Button Content="Mon" Width="270" Height="60" FontSize="24" FontWeight="Medium" Click="DayButton_Click" Tag="Monday" Foreground="#0a0a0a" Background="#bbdcda" CornerRadius="15" Opacity="0.8" FontFamily="Verdana"/>
                                        <StackPanel x:Name="MondayTimePickers" Orientation="Vertical" Spacing="0" Visibility="Collapsed"/>
                                    </StackPanel>

                                    <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Vertical" Spacing="5" Margin="10">
                                        <Button Content="Tue" Width="270" Height="60" FontSize="24" FontWeight="Medium" Click="DayButton_Click" Tag="Tuesday" Foreground="#0a0a0a" Background="#bbdcda" CornerRadius="15" Opacity="0.8" FontFamily="Verdana"/>
                                        <StackPanel x:Name="TuesdayTimePickers" Orientation="Vertical" Spacing="0" Visibility="Collapsed"/>
                                    </StackPanel>

                                    <StackPanel Grid.Row="0" Grid.Column="2" Orientation="Vertical" Spacing="5" Margin="10">
                                        <Button Content="Wed" Width="270" Height="60" FontSize="24" FontWeight="Medium" Click="DayButton_Click" Tag="Wednesday" Foreground="#0a0a0a" Background="#bbdcda" CornerRadius="15" Opacity="0.8" FontFamily="Verdana"/>
                                        <StackPanel x:Name="WednesdayTimePickers" Orientation="Vertical" Spacing="0" Visibility="Collapsed"/>
                                    </StackPanel>

                                    <StackPanel Grid.Row="0" Grid.Column="3" Orientation="Vertical" Spacing="5" Margin="10">
                                        <Button Content="Thu" Width="270" Height="60" FontSize="24" FontWeight="Medium" Click="DayButton_Click" Tag="Thursday" Foreground="#0a0a0a" Background="#bbdcda" CornerRadius="15" Opacity="0.8" FontFamily="Verdana"/>
                                        <StackPanel x:Name="ThursdayTimePickers" Orientation="Vertical" Spacing="0" Visibility="Collapsed"/>
                                    </StackPanel>

                                    <StackPanel Grid.Row="1" Grid.Column="0" Orientation="Vertical" Spacing="5" Margin="10">
                                        <Button Content="Fri" Width="270" Height="60" FontSize="24" FontWeight="Medium" Click="DayButton_Click" Tag="Friday" Foreground="#0a0a0a" Background="#bbdcda" CornerRadius="15" Opacity="0.8" FontFamily="Verdana"/>
                                        <StackPanel x:Name="FridayTimePickers" Orientation="Vertical" Spacing="0" Visibility="Collapsed"/>
                                    </StackPanel>

                                    <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Vertical" Spacing="5" Margin="10">
                                        <Button Content="Sat" Width="270" Height="60" FontSize="24" FontWeight="Medium" Click="DayButton_Click" Tag="Saturday" Foreground="#0a0a0a" Background="#bbdcda" CornerRadius="15" Opacity="0.8" FontFamily="Verdana"/>
                                        <StackPanel x:Name="SaturdayTimePickers" Orientation="Vertical" Spacing="0" Visibility="Collapsed"/>
                                    </StackPanel>

                                    <StackPanel Grid.Row="1" Grid.Column="2" Orientation="Vertical" Spacing="5" Margin="10">
                                        <Button Content="Sun" Width="270" Height="60" FontSize="24" FontWeight="Medium" Click="DayButton_Click" Tag="Sunday" Foreground="#0a0a0a" Background="#bbdcda" CornerRadius="15" Opacity="0.8" FontFamily="Verdana"/>
                                        <StackPanel x:Name="SundayTimePickers" Orientation="Vertical" Spacing="0" Visibility="Collapsed"/>
                                    </StackPanel>
                                </Grid>

                            </Grid>
                        </Border>
                    </StackPanel>
                </PivotItem>
                <PivotItem Header="AI Filtering" FontFamily="Verdana">
                    <TextBlock Text="TBD." FontFamily="Verdana"/>
                </PivotItem>
            </Pivot>
        </StackPanel>
    </ScrollViewer>
</Window>
